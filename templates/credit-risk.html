<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Credit Risk Assessment - FinSight</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="../static/css/credit-risk.css">
</head>
<body>

<!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-light fixed-top">
  <div class="container">
    <a class="navbar-brand" href="/">
      <i class="fas fa-chart-line me-2"></i>
      <span class="brand-text">FinSight</span>
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item">
          <a class="nav-link" href="index.html">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="portfolio-risk.html">Portfolio Risk</a>
        </li>
        <li class="nav-item">
          <a class="nav-link active" href="credit-risk.html">Credit Risk</a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<!-- Main Content -->
<main class="main-content">
  <div class="container-fluid">
    
    <!-- Page Header -->
    <div class="page-header">
      <div class="row align-items-center">
        <div class="col-lg-8">
          <h1 class="page-title">
            <i class="fas fa-shield-alt me-3"></i>
            üè¶ Credit Risk Assessment
          </h1>
          <p class="page-subtitle">Evaluate borrower creditworthiness and assess loan default risk with advanced analytics</p>
        </div>
        <div class="col-lg-4 text-lg-end">
          <div class="last-updated">
            <i class="fas fa-clock me-2"></i>
            Last updated: <span id="lastUpdated">--</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Input Form Section -->
    <section class="input-section">
      <div class="row">
        <div class="col-lg-8 mx-auto">
          <div class="input-card">
            <div class="card-header">
              <h3><i class="fas fa-user-check me-2"></i>Borrower Information</h3>
              <p>Enter borrower details to assess credit risk and loan eligibility</p>
            </div>
            <div class="card-body">
              <form id="creditForm">
                <div class="row g-4">
                  <div class="col-md-6">
                    <div class="form-group">
                      <label for="income" class="form-label">
                        <i class="fas fa-dollar-sign me-2"></i>Annual Income
                      </label>
                      <div class="input-group">
                        <span class="input-group-text">$</span>
                        <input type="number" class="form-control" id="income" 
                               placeholder="Enter annual income">
                      </div>
                      <div class="form-text">Gross annual income before taxes</div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group">
                      <label for="loanAmount" class="form-label">
                        <i class="fas fa-hand-holding-usd me-2"></i>Loan Amount
                      </label>
                      <div class="input-group">
                        <span class="input-group-text">$</span>
                        <input type="number" class="form-control" id="loanAmount" 
                               placeholder="Enter loan amount">
                      </div>
                      <div class="form-text">Requested loan amount</div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group">
                      <label for="creditScore" class="form-label">
                        <i class="fas fa-chart-line me-2"></i>Credit Score
                      </label>
                      <input type="number" class="form-control" id="creditScore" 
                             placeholder="300-850" 
                             min="300" max="850">
                      <div class="form-text">FICO credit score (300-850)</div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group">
                      <label for="employmentStatus" class="form-label">
                        <i class="fas fa-briefcase me-2"></i>Employment Status
                      </label>
                      <select class="form-select" id="employmentStatus">
                        <option value="" disabled selected>Select employment status</option>
                        <option value="full-time">Full-time Employee</option>
                        <option value="part-time">Part-time Employee</option>
                        <option value="self-employed">Self-employed</option>
                        <option value="contractor">Independent Contractor</option>
                        <option value="unemployed">Unemployed</option>
                        <option value="retired">Retired</option>
                      </select>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group">
                      <label for="loanTerm" class="form-label">
                        <i class="fas fa-calendar-alt me-2"></i>Loan Term
                      </label>
                      <select class="form-select" id="loanTerm">
                        <option value="" disabled selected>Select loan term</option>
                        <option value="12">12 Months</option>
                        <option value="24">24 Months</option>
                        <option value="36">36 Months</option>
                        <option value="48">48 Months</option>
                        <option value="60">60 Months</option>
                      </select>
                    </div>
                  </div>
                </div>
                <div class="form-actions">
                  <button type="submit" class="btn btn-primary btn-lg">
                    <i class="fas fa-calculator me-2"></i>
                    Assess Credit Risk
                  </button>
                  <button type="button" class="btn btn-outline-secondary btn-lg" id="clearForm">
                    <i class="fas fa-eraser me-2"></i>
                    Clear Form
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Results Section -->
    <section class="results-section" id="resultsSection" style="display: none;">
      
      <!-- Loan Decision Card -->
      <div class="row mb-5">
        <div class="col-12">
          <div class="decision-card" id="decisionCard">
            <div class="row align-items-center">
              <div class="col-md-8">
                <h2 class="decision-status" id="decisionStatus">
                  <i class="fas fa-check-circle me-2"></i>Loan Decision Pending
                </h2>
                <p class="decision-message" id="decisionMessage">
                  Processing your loan application...
                </p>
              </div>
              <div class="col-md-4">
                <div class="confidence-level">
                  <h5>Confidence Level</h5>
                  <div class="progress" style="height: 30px;">
                    <div class="progress-bar progress-bar-striped progress-bar-animated" 
                         role="progressbar" 
                         style="width: 0%" 
                         id="confidenceLevel">--</div>
                  </div>
                  <small class="text-muted d-block mt-2">AI-powered decision confidence</small>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Risk Metrics Cards -->
      <div class="row mb-5">
        <div class="col-12">
          <h2 class="section-title">
            <i class="fas fa-chart-bar me-2"></i>Risk Metrics
          </h2>
        </div>
        <div class="col-lg-4 col-md-6 mb-4">
          <div class="metric-card pd-card">
            <div class="metric-icon">
              <i class="fas fa-exclamation-triangle"></i>
            </div>
            <div class="metric-content">
              <div class="metric-label">Probability of Default (PD)</div>
              <div class="metric-value" id="pdValue">--</div>
              <div class="metric-detail">12-month probability</div>
            </div>
          </div>
        </div>
        <div class="col-lg-4 col-md-6 mb-4">
          <div class="metric-card el-card">
            <div class="metric-icon">
              <i class="fas fa-chart-line"></i>
            </div>
            <div class="metric-content">
              <div class="metric-label">Expected Loss (EL)</div>
              <div class="metric-value" id="elValue">--</div>
              <div class="metric-detail">Annual expected loss</div>
            </div>
          </div>
        </div>
        <div class="col-lg-4 col-md-6 mb-4">
          <div class="metric-card rwa-card">
            <div class="metric-icon">
              <i class="fas fa-weight-hanging"></i>
            </div>
            <div class="metric-content">
              <div class="metric-label">Risk-Weighted Assets (RWA)</div>
              <div class="metric-value" id="rwaValue">--</div>
              <div class="metric-detail">Basel III compliant</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Risk Analysis Charts -->
      <div class="row mb-5">
        <div class="col-lg-6">
          <h2 class="section-title">
            <i class="fas fa-chart-pie me-2"></i>Risk Score Breakdown
          </h2>
          <div class="chart-card">
            <canvas id="riskScoreChart"></canvas>
          </div>
        </div>
        <div class="col-lg-6">
          <h2 class="section-title">
            <i class="fas fa-chart-line me-2"></i>Default Probability Trend
          </h2>
          <div class="chart-card">
            <canvas id="defaultTrendChart"></canvas>
          </div>
        </div>
      </div>

      <!-- Stress Test Section -->
      <div class="row">
        <div class="col-12">
          <div class="stress-test-section">
            <h2 class="section-title">
              <i class="fas fa-flask me-2"></i>Stress Test Analysis
            </h2>
            <p class="section-subtitle">Evaluate loan performance under adverse economic scenarios</p>
            <div class="stress-test-card">
              <div class="stress-test-content">
                <div class="stress-test-info">
                  <h4>Adverse Scenario Simulation</h4>
                  <p>Test how the loan would perform under economic stress conditions including:</p>
                  <ul class="stress-scenarios">
                    <li><i class="fas fa-check"></i> Economic recession (GDP -3%)</li>
                    <li><i class="fas fa-check"></i> Unemployment rate increase (+5%)</li>
                    <li><i class="fas fa-check"></i> Interest rate shock (+2%)</li>
                    <li><i class="fas fa-check"></i> Credit score deterioration (-50 points)</li>
                  </ul>
                </div>
                <div class="stress-test-action">
                  <button type="button" class="btn btn-warning btn-lg" data-bs-toggle="modal" data-bs-target="#stressTestModal">
                    <i class="fas fa-play me-2"></i>
                    Run Stress Test
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

    </section>

  </div>
</main>

<!-- Stress Test Modal -->
<div class="modal fade" id="stressTestModal" tabindex="-1" aria-labelledby="stressTestModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="stressTestModalLabel">
          <i class="fas fa-flask me-2"></i>Adverse Scenario Results
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="stress-results">
          <!-- Scenario Comparison -->
          <div class="row mb-4">
            <div class="col-12">
              <h6 class="stress-section-title">Scenario Comparison</h6>
              <div class="comparison-table">
                <table class="table table-hover">
                  <thead>
                    <tr>
                      <th>Metric</th>
                      <th class="text-center">Base Case</th>
                      <th class="text-center">Adverse Scenario</th>
                      <th class="text-center">Change</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><strong>Probability of Default</strong></td>
                      <td class="text-center">2.3%</td>
                      <td class="text-center text-danger">8.7%</td>
                      <td class="text-center text-danger">+278%</td>
                    </tr>
                    <tr>
                      <td><strong>Expected Loss</strong></td>
                      <td class="text-center">$575</td>
                      <td class="text-center text-danger">$2,175</td>
                      <td class="text-center text-danger">+278%</td>
                    </tr>
                    <tr>
                      <td><strong>Risk-Weighted Assets</strong></td>
                      <td class="text-center">$20,000</td>
                      <td class="text-center text-warning">$35,000</td>
                      <td class="text-center text-warning">+75%</td>
                    </tr>
                    <tr>
                      <td><strong>Monthly Payment</strong></td>
                      <td class="text-center">$1,134</td>
                      <td class="text-center text-warning">$1,234</td>
                      <td class="text-center text-warning">+8.8%</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>

          <!-- Risk Impact Chart -->
          <div class="row mb-4">
            <div class="col-lg-8">
              <h6 class="stress-section-title">Risk Impact Visualization</h6>
              <div class="chart-card">
                <canvas id="stressTestChart"></canvas>
              </div>
            </div>
            <div class="col-lg-4">
              <h6 class="stress-section-title">Key Findings</h6>
              <div class="findings-card">
                <div class="finding-item">
                  <div class="finding-icon high-risk">
                    <i class="fas fa-exclamation-triangle"></i>
                  </div>
                  <div class="finding-content">
                    <h6>High Risk Impact</h6>
                    <p>Default probability increases significantly under stress</p>
                  </div>
                </div>
                <div class="finding-item">
                  <div class="finding-icon medium-risk">
                    <i class="fas fa-chart-line"></i>
                  </div>
                  <div class="finding-content">
                    <h6>Capital Requirements</h6>
                    <p>RWA increases by 75% requiring additional capital</p>
                  </div>
                </div>
                <div class="finding-item">
                  <div class="finding-icon low-risk">
                    <i class="fas fa-shield-alt"></i>
                  </div>
                  <div class="finding-content">
                    <h6>Payment Affordability</h6>
                    <p>Monthly payment remains manageable for borrower</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Recommendations -->
          <div class="row">
            <div class="col-12">
              <h6 class="stress-section-title">Recommendations</h6>
              <div class="recommendations">
                <div class="recommendation-item">
                  <div class="recommendation-icon">
                    <i class="fas fa-lightbulb"></i>
                  </div>
                  <div class="recommendation-content">
                    <h6>Enhanced Monitoring</h6>
                    <p>Implement quarterly credit reviews and early warning indicators</p>
                  </div>
                </div>
                <div class="recommendation-item">
                  <div class="recommendation-icon">
                    <i class="fas fa-cog"></i>
                  </div>
                  <div class="recommendation-content">
                    <h6>Risk Mitigation</h6>
                    <p>Consider additional collateral or co-signer for risk reduction</p>
                  </div>
                </div>
                <div class="recommendation-item">
                  <div class="recommendation-icon">
                    <i class="fas fa-chart-bar"></i>
                  </div>
                  <div class="recommendation-content">
                    <h6>Portfolio Diversification</h6>
                    <p>Limit exposure to similar risk profiles in the portfolio</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- Loading Overlay -->
<div class="loading-overlay" id="loadingOverlay">
  <div class="loading-content">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="loading-text">Analyzing credit risk...</p>
  </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<!-- Custom JavaScript -->
<script src="../static/js/credit-risk.js"></script>

</body>
</html>
